<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta name="viewport" content="width=320, user-scalable=yes">
	<title>login</title>
<script type ="text/javascript" src = "http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script>
<script type="text/javascript" charset="utf-8">
	var namelist;
	var nametemplate;
	var temp = ["asdf", "asdf325", "omgomgomg"];
	var lilist = new Array();
	var click=true;
	
	$(document).ready(function(){
		namelist = $("#usernamelist");
		nametemplate = $("#template");
		$("#newuser").hide();
		$("#searchtype").hide();
		$(".name").hide();
		for (var x in temp){
			var newitem = createNewItem(temp[x]);
			namelist.append(newitem);
			lilist.push(newitem);
		}
		$("#searchname").keyup(function(e){searchUsers(e);});
	});
	
/*	function displayList(list){
		$(".name").hide();
		for (var x in list){
			newname = nametemplate.clone();
			newname.find("div").html(list[x]);
			newname.show();
			namelist.append(newname);
		}
	}*/
	
	function createNewItem(name){
		newitem = nametemplate.clone();
		newitem.find("div").html(name);
		newitem.show();
		return newitem;
	}
	
	function displayList(list){
		$(".name").hide();
		for (var x in temp){
			if ($.inArray(temp[x],list)>=0){
				lilist[x].show();
			}
		}
	}
	
	function addUser(){
		$(".name").css("background","white");
		cancelSearch();
		addname=$("#newuser")[0];
		$("#searchtype").hide();
		if (addname.style.display!="block"){
			addname.style.display="block";
			click=false;
		}
		else{
			$("#newname")[0].value="";
			addname.style.display="none";
			click=true;
		}
	}
	
	function submitNewUser(){
		newname=$("#newname")[0].value;
	/*	var x=0;
		while (newname>temp[x]){
			x++;
		}
		temp.splice(x,0,newname);*/
		$("#newname")[0].value="";
		var newitem = createNewItem(newname);
		temp.splice(0,0,newname);
		newitem.insertAfter("#template");
		lilist.splice(0,0,newitem);
		addUser();
		displayList(temp);
		selectUser(newitem[0]);
	}
	
	function toggleSearch(){
		$(".name").css("background","white");
		search=$("#searchtype")[0];
		$("#newuser").hide();
		if (search.style.display!="block"){
			search.style.display="block";
		}
		else{
			$("#searchname")[0].value="";
			search.style.display="none";
			displayList(temp);
		}
	}
	
	function searchUsers(e){
		$(".name").css("background","white");
		searchname=$("#searchname")[0].value;
		if (searchname==""){
			cancelSearch();
		}
		else{
			var newlist = new Array();
			for (var x in temp){
				if (temp[x].substring(0,searchname.length)==searchname){
					newlist.push(temp[x]);
				}
			}
			displayList(newlist);
		//	search=$("#searchtype")[0];
		//	search.style.display="block";
		}
	}
	
	function cancelSearch(){
		$(".name").css("background","white");
		$("#searchname")[0].value="";
		displayList(temp);
		search=$("#searchtype")[0];
		search.style.display="block";
	}
	
	function selectUser(item){
		$(".name").css("background","white");
		if (click){
			item.style.background="#00CCFF";
		}
	}
	
</script>

<style type="text/css" media="screen">
	body{
		margin:0px;
	}
	div{
		margin:0px;
	}
	ul{
		border:solid;
		width:320px;
		list-style-type:none;
		padding:0px;
		margin:0px;
	}
	li{
		border-bottom: 1px solid black;
	}
	.line{
		width:320px;
		height:50px;
		margin:none;
		padding:none;
		clear:both;
		position:relative;
	}
	.status{
		width:25px;
		float:left;
		padding-top:12px;
		padding-bottom:12px;
	}
	.next{
		width:25px;
		float:right;
		padding-top:11px;
		padding-bottom:11px;
	}
	.icon{
		width:40px;
		float:left;
		padding-top:5px;
		padding-bottom:5px;
	}
	.username{
		width:230px;
		float:left;
		font-family:"Arial",sans-serif;
		padding-top:15px;
		padding-bottom:15px;
	}
	#add{
		width:100px;
		text-align:right;
		float:left;
		padding-top:10px;
		padding-bottom:10px;
	}
	#title{
		width:120px;
		text-align:center;
		font-size:20px;
		float:left;
		font-family:"Arial",sans-serif;
		padding-top:15px;
		padding-bottom:15px;
	}
	#search{
		width:100px;
		float:right;
		padding-top:10px;
		padding-bottom:10px;
	}
	#header{
		width:320px;
		height:50px;
		margin:none;
		padding:none;
		clear:both;
		position:relative;
		border-top:solid;
		border-left:solid;
		border-right:solid;
	}
	.textbox{
		height:25px;
		margin-top:7px;
		margin-bottom:7px;
		margin-left:5px;
		width:200px;
		font-size:17px;
	}
	#newuser{
		display:none;
	}
	#searchtype{
		display:none;
	}
</style>
</head>

<body>
	<div>
	<div id="header">
		<div id = "add"><button id="addbutton" onclick = "addUser();">Add</button></div>
		<div id ="title">Users</div>
		<div id ="search"><button id="searchbutton" onclick = "toggleSearch();">Find</button></div>
	</div>
	<ul id = "usernamelist">
		<li id = "newuser" class = "line">
			<label for="name"></label><input type="text" name="name" value="" id="newname" class="textbox">
			<button type = "submit" onclick="submitNewUser();">Create!</button>
		</li>
		<li id = "searchtype" class = "line">
			<label for="name"></label><input type="text" name="name" value="" id="searchname" class="textbox">
			<button id = "clearsearch" onclick="cancelSearch();">Cancel</button>
		</li>
		<li id ="template" class="line name" onclick = "selectUser(this);">
			<img class = "status" src = "{{ static_url("images/online.png")}}">
			<div class = "username"></div>
			<img class = "icon" src = "{{ static_url("images/icon.png")}}">
			<img class = "next" src = "{{ static_url("images/next.png")}}">
		</li>
	</ul>
	</div>
</body>
</html>
